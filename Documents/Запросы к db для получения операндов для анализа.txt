Type-CVE-Product: match (t:TYPE)--(e:EXPLOIT)--(c:CVE)--(cpe:CPE)--(p:PRODUCT) return t.id as Source, p.id as Target, count(e) as Weight - вес - число эксплоитов
Exploit-CVE-Product : match(e:EXPLOIT)--(c:CVE)--(cpe:CPE)--(p:PRODUCT) return e.name as Source, p.id as Target, count(c) as Weight

match (cve:CVE)--(cpe:CPE)--(p:PRODUCT) where p.k > 2 return cve.id as Source, p.id as Target, count(cpe) as Weight
match (cve:CVE)--(cpe:CPE)--(p:PRODUCT) set p.k = 0 
match (cve:CVE)--(cpe:CPE)--(p:PRODUCT) set p.k = p.k + 1




\LOAD CSV WITH HEADERS FROM "file:///cl" AS c FIELDTERMINATOR '\u0009' - 1 операнд
match (cve:CVE {cluster:toInteger(c['N'])})  
return cve.cluster,toFloat(count(cve))/32762




unwind range (0,60) as cl1 - 2 операнд
match (o:CVE) where o.cluster1 = cl1
optional match (e:EXPLOIT)--(o)
return toFloat(count(DISTINCT e))/toFloat(count(o)), o.cluster1, datetime(o.date).year

LOAD CSV WITH HEADERS FROM "file:///cl" AS c FIELDTERMINATOR '\u0009'
match (cve:CVE {cluster_new:toInteger(c['N'])})
optional match (e:EXPLOIT)--(cve)
return toFloat(count(DISTINCT e))/toFloat(count(cve)), cve.cluster_new, datetime(cve.date).year



LOAD CSV WITH HEADERS FROM "file:///cl" AS c FIELDTERMINATOR '\u0009'
match (cve:CVE {cluster1:toInteger(c['N'])})--(cvss3:CVSS3)
return cve.cluster1, sum(cvss3.baseScore3)/count(cvss3)/10, datetime(cve.date).year

LOAD CSV WITH HEADERS FROM "file:///cl" AS c FIELDTERMINATOR '\u0009'
match (cve:CVE {cluster_new:toInteger(c['N'])})--(cvss3:CVSS3)
return cve.cluster_new, sum(cvss3.baseScore3)/count(cvss3)/10, datetime(cve.date).year